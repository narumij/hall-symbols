module Crystallography.HallSymbols.LikeITC (
--  generatorSelected,
  generatorsSelected,
  generatorsSelectedTable,
  symmetryOperations,
  ) where

import Data.Maybe
import Data.List (nub)
import Data.Matrix

import Data.Matrix.SymmetryOperationsSymbols

import Crystallography.HallSymbols
import Crystallography.HallSymbols.SpacegroupSymbols

import Data.Matrix.AsXYZ
import Data.Matrix.SymmetryOperationsSymbols

generateLikeITC selected = nub $ gen [] selected
  where
    gen a  []    = a
    gen [] (b:c) = gen [b] c
    gen a  (b:c) = gen (a ++ multSymop b a) c

hogehoge :: [[Matrix Rational]] -> IO ()
hogehoge mm = mapM_ putStrLn hoge
  where
    hoge :: [String]
    hoge = concat $ map fromMatrix' h
    h :: [Matrix Rational]
    h = concat mm

generatorsSelected numberAndChoice = case select <$> symop <*> indices of
  Just a -> a
  Nothing -> []
  where
    symbol = fromNumberAndChoice numberAndChoice
    symop = fromHallSymbols' <$> symbol
    indices = selectGeneratorIndices numberAndChoice

generatorsSelected' numberAndChoice = case select' <$> symop <*> indices of
  Just a -> a
  Nothing -> []
  where
    symbol = fromNumberAndChoice numberAndChoice
    symop = fromHallSymbols' <$> symbol
    indices = selectGeneratorIndices numberAndChoice

symmetryOperations numberAndChoice = map generateLikeITC $ generatorsSelected' numberAndChoice

selectGeneratorIndices numberAndChoice = lookup numberAndChoice generatorsSelectedTable

select symops (a,b) = [[ symops !! n | n <- idx] | idx <- indices]
  where
    indices = [a,b]

select' symops (a,b) = [[ symops !! n | n <- idx] | idx <- indices]
  where
    indices = [ [c] ++ b | c <- a]

generatorsSelectedTable :: [([Char], ([Int], [Int]))]
generatorsSelectedTable = [

  ("1", ([0],[])),

  ("2", ([0],[1])),

  ("3:b", ([0],[1])),
  ("3:c", ([0],[1])),

  ("4:b",([0],[1])),
  ("4:c",([0],[1])),

  ("5:b1",([0,1],[2])),
  ("5:b2",([0,1],[2])),
  ("5:b3",([0,1],[2])),

  ("5:c1",([0,1],[2])),
  ("5:c2",([0,1],[2])),
  ("5:c3",([0,1],[2])),

  ("6:b",([0],[1])),
  ("6:c",([0],[1])),

  ("7:b1",([0],[1])),
  ("7:b2",([0],[1])),
  ("7:b3",([0],[1])),
  ("7:c1",([0],[1])),
  ("7:c2",([0],[1])),
  ("7:c3",([0],[1])),

  ("8:b1",([0,1],[2])),
  ("8:b2",([0,1],[2])),
  ("8:b3",([0,1],[2])),
  ("8:c1",([0,1],[2])),
  ("8:c2",([0,1],[2])),
  ("8:c3",([0,1],[2])),

  ("9:b1",([0,1],[2])),
  ("9:b2",([0,1],[2])),
  ("9:b3",([0,1],[2])),
  ("9:c1",([0,1],[2])),
  ("9:c2",([0,1],[2])),
  ("9:c3",([0,1],[2])),

  ("10:b",([0],[2,1])),
  ("10:c",([0],[2,1])),

  ("11:b",([0],[2,1])),
  ("11:c",([0],[2,1])),

-- TODO:CHECK
  ("12:b1",([0,1],[4,2])),
  ("12:b2",([0,1],[4,2])),
  ("12:b3",([0,1],[4,2])),
  ("12:c1",([0,1],[4,2])),
  ("12:c2",([0,1],[4,2])),
  ("12:c3",([0,1],[4,2])),

-- TODO:CHECK
  ("13:b1",([0],[2,1])),
  ("13:b2",([0],[2,1])), 
  ("13:b3",([0],[2,1])),
  ("13:c1",([0],[2,1])),
  ("13:c2",([0],[2,1])),
  ("13:c3",([0],[2,1])),

-- TODO:CHECK
  ("14:b1",([0],[2,1])),
  ("14:b2",([0],[2,1])),
  ("14:b3",([0],[2,1])),
  ("14:c1",([0],[2,1])),
  ("14:c2",([0],[2,1])),
  ("14:c3",([0],[2,1])),

-- TODO:CHECK
  ("15:b1",([0,1],[4,2])),
  ("15:b2",([0,1],[4,2])),
  ("15:b3",([0,1],[4,2])),
  ("15:c1",([0,1],[4,2])),
  ("15:c2",([0,1],[4,2])),
  ("15:c3",([0,1],[4,2])),

  ("16",([0],[1,3])),

  ("17",([0],[1,3])),

  ("18",([0],[1,3])),

  ("19",([0],[1,3])),

  ("20",([0,1],[2,6])),

  ("21",([0,1],[2,6])),

  ("22",([0,1,2,3],[4,12,5])),

  ("23",([0,1],[2,6,3])),

  ("24",([0,1],[4,6])),

  ("25",([0],[1,3])),

  ("26",([0],[1,3])),

  ("27",([0],[1,3])),

  ("28",([0],[1,3])),

  ("29",([0],[1,3])),

  ("30",([0],[1,3])),

  ("31",([0],[1,3])),

  ("32",([0],[1,3])),

  ("33",([0],[1,3])),

  ("34",([0],[1,3])),

  ("35",([0,1],[2,6])),

  ("36",([0,1],[2,6])),

  ("37",([0,1],[2,6])),

  ("38",([0,1],[2,6])),

  ("39",([0,1],[2,7])),

  ("40",([0,1],[2,6])),

  ("41",([0,1],[2,7])),

  ("42",([0,1,2,3],[4,12])),

  ("43",([0,1,2,3],[4,13])),

  ("44",([0,1],[2,6])),

  ("45",([0,1],[2,7])),

  ("46",([0,1],[2,6])),

  ("47",([0],[2,6,1])),

  ("48:1",([0],[1,4,2,3])),
  ("48:2",([0],[2,6,3,1])),

  ("49",([0],[2,6,1])),

  ("50:1",([0],[1,4,3])),
  ("50:2",([0],[2,6,1])),

  ("51",([0],[2,6,1])),

  ("52",([0],[2,6,1])),

  ("53",([0],[2,6,1])),

  ("54",([0],[2,6,1])),

  ("55",([0],[2,6,1])),

  ("56",([0],[2,6,1])),

  ("57",([0],[2,6,1])),

  ("58",([0],[2,6,1])),

  ("59:1",([0],[1,4,3])),
  ("59:2",([0],[2,6,1])),

  ("60",([0],[2,6,1])),

  ("61",([0],[2,6,1])),

  ("62",([0],[2,6,1])),

  ("63",([0,1],[4,12,2])),

  ("64",([0,1],[4,12,2])),

  ("65",([0,1],[4,12,2])),

  ("66",([0,1],[4,12,2])),

  ("67",([0,1],[4,12,2])),

  ("68:1",([0,1],[5,8,4])),
  ("68:2",([0,1],[6,12,2])),

  ("69",([0,1,2,3],[8,24,4])),

  ("70:1",([0,1,2,3],[4,16,5,6])),
  ("70:2",([0,1,2,3],[14,26,4])),

  ("71",([0,1],[4,12,5,2])),

  ("72",([0,1],[4,13,3])),

  ("73",([0,1],[6,12,2])),

  ("74",([0,1],[4,12,2])),

  ("75",([0],[2,1])),

  ("76",([0],[2,1])),

  ("77",([0],[2,1])),

  ("78",([0],[2,1])),

  ("79",([0,1],[4,2])),

  ("80",([0,1],[4,2])),

  ("81",([0],[2,1])),

  ("82",([0,1],[4,2])),

  ("83",([0],[4,2,1])),

  ("84",([0],[4,2,1])),

  ("85:1",([0],[3,1,2])),
  ("85:2",([0],[4,2,1])),

  ("86:1",([0],[3,1,2])),
  ("86:2",([0],[4,2,1])),

  ("87",([0,1],[8,4,3])),

  ("88:1",([0,1],[6,2,3])),
  ("88:2",([0,1],[8,4,2])),

  ("89",([0],[3,1,7])),

  ("90",([0],[3,1,7])),

  ("91",([0],[3,1,7])),

  ("92",([0],[3,1,7])),

  ("93",([0],[3,1,7])),

  ("94",([0],[3,1,7])),

  ("95",([0],[3,1,7])),

  ("96",([0],[3,1,7])),

  ("97",([0,1],[6,2,13])),

  ("98",([0,1],[6,2,13])),

  ("99",([0],[3,1,7])),

  ("100",([0],[3,1,7])),

  ("101",([0],[3,1,7])),

  ("102",([0],[3,1,7])),

  ("103",([0],[3,1,7])),

  ("104",([0],[3,1,7])),

  ("105",([0],[3,1,7])),

  ("106",([0],[3,1,7])),

  ("107",([0,1],[6,2,13])),

  ("108",([0,1],[6,2,13])),

  ("109",([0,1],[6,2,13])),

  ("110",([0,1],[6,2,13])),

  ("111",([0],[3,1,7])),

  ("112",([0],[3,1,7])),

  ("113",([0],[3,1,7])),

  ("114",([0],[3,1,7])),

  ("115",([0],[3,1,7])),

  ("116",([0],[3,1,7])),

  ("117",([0],[3,1,7])),

  ("118",([0],[3,1,7])),

  ("119",([0,1],[6,2,13])),

  ("120",([0,1],[6,2,13])),

  ("121",([0,1],[6,2,13])),

  ("122",([0,1],[6,2,13])),

  ("123",([0,1],[6,2,13])),

  ("124",([0,1],[6,2,13])),

  ("125:1",([0],[4,1,10,3])),
  ("125:2",([0],[6,2,13,1])),

  ("126:1",([0],[4,1,10,3])),
  ("126:2",([0],[6,2,13,1])),

  ("127",([0],[6,2,13,1])),

  ("128",([0],[6,2,13,1])),

  ("129:1",([0],[4,1,10,3])),
  ("129:2",([0],[6,2,13,1])),

  ("130:1",([0],[4,1,10,3])),
  ("130:2",([0],[6,2,13,1])),

  ("131",([0],[6,2,13,1])),

  ("132",([0],[6,2,13,1])),

  ("133:1",([0],[4,1,10,3])),
  ("133:2",([0],[6,2,13,1])),

  ("134:1",([0],[4,1,10,3])),
  ("134:2",([0],[6,2,13,1])),

  ("135",([0],[6,2,13,1])),

  ("136",([0],[6,2,13,1])),

  ("137:1",([0],[4,1,10,3])),
  ("137:2",([0],[6,2,13,1])),

  ("138:1",([0],[4,1,10,3])),
  ("138:2",([0],[6,2,13,1])),

  ("139",([0,1],[12,4,25,3])),

  ("140",([0,1],[12,4,25,3])),

  ("141:1", ([0,1],[8,2,19,4])),
  ("141:2", ([0,1],[12,4,25,3]))
  ]

